<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>اختبار تحمّل الضغط</title>
<style>
body{
  background:#0f172a;
  color:white;
  font-family:Tahoma, Arial;
  text-align:center;
  padding:25px;
}
h1{margin-bottom:5px;}
#scenario{margin:20px 0;font-size:18px;line-height:1.6;}
button{
  display:block;
  width:100%;
  max-width:420px;
  margin:10px auto;
  padding:14px;
  border:none;
  border-radius:10px;
  font-size:16px;
  background:#2563eb;
  color:white;
}
button:active{transform:scale(.97);}
#timer{margin:10px;font-size:16px;color:#38bdf8;}
#result{margin-top:30px;line-height:1.8;}
</style>
</head>
<body>

<h1>اختبار تحمّل الضغط</h1>
<div id="round"></div>
<div id="timer"></div>
<div id="scenario"></div>
<div id="choices"></div>
<div id="result"></div>

<script>

let الجولة = 1;
let الحد_الأقصى = 10;
let المؤقت;
let الوقت = 12;

let الملف = {
  السرعة: [],
  المخاطرة: 0,
  المواجهة: 0,
  التجنب: 0,
  الاتساق: 0,
  اخر_اختيار: null
};

function تشغيل_المؤقت(){
  الوقت = 12;
  document.getElementById("timer").innerText = "الوقت المتبقي: " + الوقت;
  المؤقت = setInterval(()=>{
    الوقت--;
    document.getElementById("timer").innerText = "الوقت المتبقي: " + الوقت;
    if(الوقت <= 0){
      clearInterval(المؤقت);
      الجولة_التالية();
    }
  },1000);
}

function اختيار(الحرف, السمات){
  clearInterval(المؤقت);
  الملف.السرعة.push(12 - الوقت);
  الملف.المخاطرة += السمات.مخاطرة;
  الملف.المواجهة += السمات.مواجهة;
  الملف.التجنب += السمات.تجنب;

  if(الملف.اخر_اختيار && الملف.اخر_اختيار === الحرف){
    الملف.الاتساق++;
  }

  الملف.اخر_اختيار = الحرف;
  الجولة_التالية();
}

function توليد_سيناريو(){
  let النص = "";
  let الخيارات = "";

  if(الملف.المخاطرة > 4){
    النص = "استثمرت مبلغًا كبيرًا في مشروع عالي المخاطر، والآن هناك احتمال خسارة. ماذا تفعل؟";
  } else if(الملف.المواجهة > الملف.التجنب){
    النص = "أحد أعضاء فريقك يعارضك علنًا أمام الجميع. كيف تتصرف؟";
  } else {
    النص = "عميل مهم ينتظر قرارك بسرعة تحت ضغط كبير.";
  }

  الخيارات += `<button onclick="اختيار('A',{مخاطرة:1,مواجهة:1,تجنب:0})">أتصرف فورًا وأتحمل المسؤولية</button>`;
  الخيارات += `<button onclick="اختيار('B',{مخاطرة:0,مواجهة:0,تجنب:1})">أؤجل القرار وأراقب الوضع</button>`;
  الخيارات += `<button onclick="اختيار('C',{مخاطرة:2,مواجهة:1,تجنب:0})">أقوم بخطوة جريئة رغم المخاطر</button>`;
  الخيارات += `<button onclick="اختيار('D',{مخاطرة:0,مواجهة:0,تجنب:2})">أنسحب من الموقف</button>`;

  document.getElementById("scenario").innerText = النص;
  document.getElementById("choices").innerHTML = الخيارات;
}

function الجولة_التالية(){
  if(الجولة >= الحد_الأقصى){
    عرض_النتائج();
    return;
  }
  الجولة++;
  document.getElementById("round").innerText = "الجولة " + الجولة + " من " + الحد_الأقصى;
  توليد_سيناريو();
  تشغيل_المؤقت();
}

function عرض_النتائج(){
  document.getElementById("choices").innerHTML = "";
  document.getElementById("scenario").innerHTML = "";

  let متوسط = الملف.السرعة.reduce((a,b)=>a+b,0)/الملف.السرعة.length;

  let تحليل = `
  <h2>تحليلك تحت الضغط</h2>
  سرعة القرار: ${متوسط < 5 ? "سريع جدًا" : "متزن"} <br>
  مستوى المخاطرة: ${الملف.المخاطرة > 10 ? "مرتفع" : "متوسط"} <br>
  الأسلوب الاجتماعي: ${الملف.المواجهة > الملف.التجنب ? "مواجه" : "متجنب"} <br>
  درجة الاتساق: ${الملف.الاتساق > 4 ? "ثابت في قراراتك" : "مرن ومتغير"} <br><br>
  <strong>الخلاصة:</strong><br>
  ${توليد_خلاصة(متوسط)}
  `;

  document.getElementById("result").innerHTML = تحليل;
}

function توليد_خلاصة(متوسط){
  if(متوسط < 5 && الملف.المخاطرة > 10){
    return "تميل لاتخاذ قرارات سريعة وجريئة تحت الضغط، لديك قابلية قيادية لكنك قد تتعرض لمخاطر عالية.";
  }
  if(الملف.التجنب > الملف.المواجهة){
    return "تميل إلى تجنب التصعيد والحفاظ على الاستقرار، تفضل الأمان على المجازفة.";
  }
  return "تتصرف بتوازن نسبي تحت الضغط وتملك قدرة جيدة على التحكم في المواقف.";
}

document.getElementById("round").innerText = "الجولة 1 من " + الحد_الأقصى;
توليد_سيناريو();
تشغيل_المؤقت();

</script>
</body>
</html>

<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Ù‚Ø§Ù…ÙˆØ³ÙŠ Ø§Ù„ØµÙˆØªÙŠ</title>
<style>
body{margin:0;font-family:Tahoma;background:#0f172a;color:#fff;text-align:center;padding:20px}
h2{margin-bottom:10px}
button{
width:200px;height:200px;border-radius:100%;
border:none;background:#2563eb;color:#fff;
font-size:22px;margin:20px auto;display:block;
}
button:active{transform:scale(.95)}
#result{margin-top:20px;font-size:24px}
#status{margin-top:10px;font-size:14px;color:#38bdf8}
</style>
</head>
<body>

<h2>ğŸ¤ Ù‚Ø§Ù…ÙˆØ³ÙŠ Ø§Ù„ØµÙˆØªÙŠ</h2>
<button onclick="startListening()">ğŸ¤</button>

<div id="status"></div>
<div id="result"></div>

<script>

let DICT = {};

async function loadDictionary(){
const res = await fetch("./dictionary_ar_en.json", {cache:"no-store"});
DICT = await res.json();
}

function cleanWord(text){
text = text.replace("Ø£Ø¨ØºÙ‰","")
.replace("Ø§Ø¨ØºÙ‰","")
.replace("ÙƒÙ„Ù…Ø©","")
.replace("Ø¨Ø§Ù„Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠ","")
.replace("Ø§Ù„Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠ","")
.replace("Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ","")
.trim();

if(text.startsWith("Ø§Ù„")){
text = text.substring(2);
}
return text.trim();
}

function speakEnglish(word){
const u = new SpeechSynthesisUtterance(word);
u.lang="en-US";
u.rate=0.75;
speechSynthesis.cancel();
speechSynthesis.speak(u);
}

function startListening(){
const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
if(!SpeechRecognition){
alert("Ø§Ø³ØªØ®Ø¯Ù… Ù…ØªØµÙØ­ Chrome");
return;
}

const recog = new SpeechRecognition();
recog.lang="ar-SA";
recog.start();

document.getElementById("status").innerText="ğŸ§ Ø£Ø³Ù…Ø¹Ùƒ...";

recog.onresult=function(event){
let spoken = event.results[0][0].transcript;
document.getElementById("status").innerText="Ø³Ù…Ø¹Øª: "+spoken;

let word = cleanWord(spoken);

if(DICT[word]){
document.getElementById("result").innerText=DICT[word];
speakEnglish(DICT[word]);
}else{
document.getElementById("result").innerText="âŒ Ø§Ù„ÙƒÙ„Ù…Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©";
}
};
}

window.onload = loadDictionary;

</script>

</body>
</html>
